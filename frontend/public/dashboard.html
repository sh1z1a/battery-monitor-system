<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Monitoring Baterai Server</title>
  <link rel="stylesheet" href="dashboard.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="7" width="20" height="12" rx="2"/>
            <rect x="22" y="10" width="2" height="4"/>
            <rect x="6" y="11" width="4" height="4" fill="currentColor"/>
          </svg>
          <h1>Server Battery Monitor</h1>
        </div>
        <div class="header-status">
          <span id="connection-status" class="status-badge offline">
            <span class="status-dot"></span>
            Offline
          </span>
          <span id="last-update">Update terakhir: --:--:--</span>
        </div>
      </div>
    </header>

    <!-- Main Dashboard -->
    <main class="dashboard">
      <!-- Battery Status Card -->
      <section class="card battery-card">
        <h2>Status Baterai</h2>
        <div class="battery-display">
          <div class="battery-gauge">
            <div class="battery-body">
              <div id="battery-fill" class="battery-fill" style="width: 0%"></div>
              <span id="battery-percentage" class="battery-text">--%</span>
            </div>
            <div class="battery-tip"></div>
          </div>
          <div id="battery-status" class="battery-status">
            <span class="status-icon">⚡</span>
            <span class="status-text">Memuat...</span>
          </div>
        </div>
        <div class="battery-details">
          <div class="detail-item">
            <span class="detail-label">Tegangan</span>
            <span id="voltage" class="detail-value">-- V</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Arus</span>
            <span id="current" class="detail-value">-- A</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Daya</span>
            <span id="power" class="detail-value">-- W</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Sisa Waktu</span>
            <span id="time-remaining" class="detail-value">-- menit</span>
          </div>
        </div>
      </section>

      <!-- Relay Control Card -->
      <section class="card control-card">
        <h2>Kontrol Relay</h2>
        <div class="relay-display">
          <div id="relay-indicator" class="relay-indicator off">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18.36 6.64a9 9 0 1 1-12.73 0"/>
              <line x1="12" y1="2" x2="12" y2="12"/>
            </svg>
          </div>
          <p id="relay-status-text" class="relay-status-text">Status: Nonaktif</p>
        </div>
        
        <div class="control-buttons">
          <button id="btn-on" class="btn btn-on" onclick="toggleRelay(true)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="16"/>
            </svg>
            AKTIFKAN
          </button>
          <button id="btn-off" class="btn btn-off" onclick="showConfirmDialog()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="8" y1="12" x2="16" y2="12"/>
            </svg>
            NONAKTIFKAN
          </button>
        </div>

        <div class="auto-shutoff">
          <label class="checkbox-label">
            <input type="checkbox" id="auto-shutoff" onchange="updateAutoShutoff()">
            <span>Auto-shutoff jika baterai &lt;</span>
            <input type="number" id="shutoff-threshold" value="20" min="5" max="50" class="threshold-input">
            <span>%</span>
          </label>
        </div>
      </section>

      <!-- System Info Card -->
      <section class="card system-card">
        <h2>Informasi Sistem</h2>
        <div class="system-info">
          <div class="info-row">
            <span class="info-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="4" y="4" width="16" height="16" rx="2"/>
                <rect x="9" y="9" width="6" height="6"/>
                <line x1="9" y1="1" x2="9" y2="4"/>
                <line x1="15" y1="1" x2="15" y2="4"/>
                <line x1="9" y1="20" x2="9" y2="23"/>
                <line x1="15" y1="20" x2="15" y2="23"/>
              </svg>
              Arduino
            </span>
            <span id="arduino-status" class="info-value status-offline">Terputus</span>
          </div>
          <div class="info-row">
            <span class="info-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m9 9a9 9 0 0 1-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9"/>
              </svg>
              API Server
            </span>
            <span id="api-status" class="info-value status-offline">Terputus</span>
          </div>
          <div class="info-row">
            <span class="info-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12 6 12 12 16 14"/>
              </svg>
              Uptime
            </span>
            <span id="uptime" class="info-value">--</span>
          </div>
          <div class="info-row">
            <span class="info-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/>
              </svg>
              Suhu Baterai
            </span>
            <span id="temperature" class="info-value">-- °C</span>
          </div>
          <div class="info-row">
            <span class="info-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
              </svg>
              Kesehatan
            </span>
            <span id="health" class="info-value">-- %</span>
          </div>
        </div>
      </section>

      <!-- Activity Log Card -->
      <section class="card log-card">
        <h2>Log Aktivitas</h2>
        <div id="activity-log" class="activity-log">
          <div class="log-empty">Belum ada aktivitas tercatat</div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <p>Server Battery Monitor v1.0 | Polling interval: <span id="polling-interval">5</span> detik</p>
    </footer>
  </div>

  <!-- Confirm Dialog -->
  <div id="confirm-dialog" class="dialog-overlay" style="display: none;">
    <div class="dialog">
      <div class="dialog-icon warning">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
          <line x1="12" y1="9" x2="12" y2="13"/>
          <line x1="12" y1="17" x2="12.01" y2="17"/>
        </svg>
      </div>
      <h3>Konfirmasi Pemutusan Arus</h3>
      <p>Anda akan memutus arus listrik ke baterai server. Tindakan ini dapat menyebabkan gangguan layanan.</p>
      <p class="warning-text">Pastikan semua data telah disimpan!</p>
      <div class="dialog-buttons">
        <button class="btn btn-cancel" onclick="hideConfirmDialog()">Batal</button>
        <button class="btn btn-confirm" onclick="confirmDisconnect()">Ya, Putuskan Arus</button>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="toast" style="display: none;"></div>

  <script src="dashboard.js"></script>
</body>
</html>